{
  "scanId": "1755482304878",
  "timestamp": "2025-08-17T00:00:00.000Z",
  "ksiId": "KSI-TPR-01",
  "scanType": "automated",
  "status": "completed",
  "results": {
    "summary": {
      "totalChecks": 6,
      "passed": 3,
      "failed": 3,
      "warnings": 0
    },
    "thirdPartyResourceIdentificationChecks": [
      {
        "checkId": "TPR-01-001",
        "name": "Software Dependency Inventory",
        "status": "PASS",
        "severity": "HIGH",
        "description": "All software dependencies should be automatically discovered and cataloged across all environments",
        "findings": {
          "packageManagementSystems": {
            "npmDependencies": {
              "totalPackages": 1247,
              "directDependencies": 89,
              "transitiveDependencies": 1158,
              "vulnerablePackages": 23,
              "licenseCompliantPackages": 1189,
              "unknownLicensePackages": 35,
              "packageManifestFiles": [
                "/app/package.json",
                "/api/package.json",
                "/worker/package.json"
              ]
            },
            "nugetDependencies": {
              "totalPackages": 67,
              "directDependencies": 12,
              "transitiveDependencies": 55,
              "vulnerablePackages": 3,
              "licenseCompliantPackages": 64,
              "unknownLicensePackages": 0,
              "packageManifestFiles": ["/src/FedRAMP20x.csproj", "/tests/FedRAMP20x.Tests.csproj"]
            },
            "pythonDependencies": {
              "totalPackages": 156,
              "directDependencies": 23,
              "transitiveDependencies": 133,
              "vulnerablePackages": 8,
              "licenseCompliantPackages": 142,
              "unknownLicensePackages": 6,
              "packageManifestFiles": ["/scripts/requirements.txt", "/automation/requirements.txt"]
            }
          },
          "containerImageDependencies": {
            "baseImages": {
              "totalBaseImages": 12,
              "officialImages": 9,
              "thirdPartyImages": 3,
              "vulnerableImages": 2,
              "lastScannedTimestamp": "2025-08-16T18:30:00.000Z",
              "imageDetails": [
                {
                  "image": "mcr.microsoft.com/dotnet/aspnet:8.0",
                  "vulnerabilities": 0,
                  "license": "MIT",
                  "lastUpdated": "2025-08-10T00:00:00.000Z"
                },
                {
                  "image": "node:18-alpine",
                  "vulnerabilities": 1,
                  "license": "MIT",
                  "lastUpdated": "2025-08-12T00:00:00.000Z"
                }
              ]
            },
            "applicationLayers": {
              "totalLayers": 45,
              "customLayers": 15,
              "thirdPartyLayers": 30,
              "vulnerableComponents": 5,
              "securityScanningEnabled": true
            }
          },
          "cloudServiceDependencies": {
            "azureServices": {
              "totalServices": 23,
              "managedServices": 18,
              "thirdPartyMarketplaceServices": 5,
              "federallyAuthorizedServices": 21,
              "unauthorizedServices": 2,
              "serviceDetails": [
                {
                  "serviceName": "Azure App Service",
                  "fedrampAuthorized": true,
                  "authorizationLevel": "FedRAMP High",
                  "lastVerified": "2025-08-15T00:00:00.000Z"
                },
                {
                  "serviceName": "Azure SQL Database",
                  "fedrampAuthorized": true,
                  "authorizationLevel": "FedRAMP High",
                  "lastVerified": "2025-08-15T00:00:00.000Z"
                }
              ]
            },
            "externalApiDependencies": {
              "totalExternalApis": 15,
              "authenticatedApis": 12,
              "publicApis": 3,
              "fedrampAuthorizedApis": 8,
              "unauthorizedApis": 7,
              "apiDetails": [
                {
                  "apiName": "Azure AD Graph API",
                  "endpoint": "https://graph.microsoft.com",
                  "fedrampAuthorized": true,
                  "dataClassification": "Federal"
                },
                {
                  "apiName": "GitHub API",
                  "endpoint": "https://api.github.com",
                  "fedrampAuthorized": false,
                  "dataClassification": "Public"
                }
              ]
            }
          }
        },
        "testResults": [
          {
            "test": "Package dependency discovery and cataloging",
            "result": "COMPREHENSIVE",
            "details": "1470 total packages identified across npm, NuGet, and Python ecosystems"
          },
          {
            "test": "Container image dependency analysis",
            "result": "COMPLETE",
            "details": "12 base images and 45 layers analyzed with vulnerability scanning"
          },
          {
            "test": "Cloud service and API dependency mapping",
            "result": "EXTENSIVE",
            "details": "23 Azure services and 15 external APIs cataloged with FedRAMP status"
          }
        ],
        "remediation": "Third-party software dependencies comprehensively identified and cataloged"
      },
      {
        "checkId": "TPR-01-002",
        "name": "Infrastructure as Code Dependency Scanning",
        "status": "PASS",
        "severity": "HIGH",
        "description": "IaC templates should be scanned to identify all third-party resources and dependencies",
        "findings": {
          "terraformDependencies": {
            "providerDependencies": {
              "totalProviders": 8,
              "officialProviders": 6,
              "communityProviders": 2,
              "verifiedProviders": 7,
              "unverifiedProviders": 1,
              "providerDetails": [
                {
                  "provider": "azurerm",
                  "version": "3.71.0",
                  "source": "hashicorp/azurerm",
                  "verified": true,
                  "fedrampCompliant": true
                },
                {
                  "provider": "azuread",
                  "version": "2.41.0",
                  "source": "hashicorp/azuread",
                  "verified": true,
                  "fedrampCompliant": true
                }
              ]
            },
            "moduleDependencies": {
              "totalModules": 15,
              "officialModules": 8,
              "communityModules": 7,
              "verifiedModules": 12,
              "unverifiedModules": 3,
              "moduleDetails": [
                {
                  "module": "Azure/aks/azurerm",
                  "version": "7.5.0",
                  "source": "Azure/aks/azurerm",
                  "verified": true,
                  "securityBaseline": "CIS Kubernetes Benchmark"
                }
              ]
            }
          },
          "armBicepDependencies": {
            "templateDependencies": {
              "totalTemplates": 23,
              "microsoftTemplates": 18,
              "communityTemplates": 5,
              "verifiedTemplates": 21,
              "unverifiedTemplates": 2,
              "templateDetails": [
                {
                  "template": "Microsoft.Web/sites",
                  "apiVersion": "2022-09-01",
                  "provider": "Microsoft.Web",
                  "fedrampAuthorized": true
                }
              ]
            },
            "extensionDependencies": {
              "totalExtensions": 7,
              "microsoftExtensions": 5,
              "thirdPartyExtensions": 2,
              "verifiedExtensions": 6,
              "unverifiedExtensions": 1
            }
          },
          "kubernetesDependencies": {
            "helmCharts": {
              "totalCharts": 12,
              "officialCharts": 8,
              "communityCharts": 4,
              "verifiedCharts": 10,
              "unverifiedCharts": 2,
              "chartDetails": [
                {
                  "chart": "ingress-nginx",
                  "version": "4.7.1",
                  "repository": "https://kubernetes.github.io/ingress-nginx",
                  "verified": true,
                  "securityScanResult": "PASS"
                }
              ]
            },
            "customResourceDefinitions": {
              "totalCrds": 8,
              "officialCrds": 5,
              "thirdPartyCrds": 3,
              "verifiedCrds": 6,
              "unverifiedCrds": 2
            }
          }
        },
        "testResults": [
          {
            "test": "Terraform provider and module dependency analysis",
            "result": "COMPREHENSIVE",
            "details": "8 providers and 15 modules identified with verification status and compliance mapping"
          },
          {
            "test": "ARM/Bicep template dependency scanning",
            "result": "COMPLETE",
            "details": "23 templates and 7 extensions cataloged with FedRAMP authorization status"
          },
          {
            "test": "Kubernetes Helm chart and CRD dependency mapping",
            "result": "THOROUGH",
            "details": "12 Helm charts and 8 CRDs identified with security scanning results"
          }
        ],
        "remediation": "Infrastructure as Code dependencies comprehensively identified and verified"
      },
      {
        "checkId": "TPR-01-003",
        "name": "Runtime Environment Discovery",
        "status": "PASS",
        "severity": "MEDIUM",
        "description": "Runtime environments should be continuously monitored to discover dynamically loaded third-party resources",
        "findings": {
          "applicationRuntimeDependencies": {
            "dynamicallyLoadedLibraries": {
              "totalLibraries": 234,
              "systemLibraries": 189,
              "thirdPartyLibraries": 45,
              "vulnerableLibraries": 8,
              "unknownLibraries": 3,
              "libraryDetails": [
                {
                  "library": "libssl.so.1.1",
                  "version": "1.1.1f",
                  "source": "OpenSSL",
                  "vulnerabilities": 0,
                  "lastUpdated": "2025-08-10T00:00:00.000Z"
                }
              ]
            },
            "runtimeDependencies": {
              "nodeModulesRuntime": 1247,
              "dotnetAssembliesRuntime": 67,
              "pythonPackagesRuntime": 156,
              "discrepanciesWithManifests": 12,
              "undeclaredDependencies": 8
            }
          },
          "networkRuntimeDependencies": {
            "externalNetworkConnections": {
              "totalConnections": 45,
              "httpsConnections": 41,
              "httpConnections": 4,
              "authorizedEndpoints": 38,
              "unauthorizedEndpoints": 7,
              "connectionDetails": [
                {
                  "endpoint": "https://login.microsoftonline.com",
                  "purpose": "Azure AD Authentication",
                  "fedrampAuthorized": true,
                  "dataClassification": "Federal"
                },
                {
                  "endpoint": "https://api.github.com",
                  "purpose": "Source Code Management",
                  "fedrampAuthorized": false,
                  "dataClassification": "Public"
                }
              ]
            },
            "dnsResolutions": {
              "totalQueries": 1234,
              "authorizedDomains": 1156,
              "unauthorizedDomains": 78,
              "suspiciousDomains": 3,
              "blockedQueries": 15
            }
          },
          "cloudRuntimeDependencies": {
            "cloudServiceInvocations": {
              "azureServiceCalls": 2456,
              "externalServiceCalls": 234,
              "fedrampAuthorizedCalls": 2234,
              "unauthorizedCalls": 456,
              "serviceCallDetails": [
                {
                  "service": "Azure Key Vault",
                  "endpoint": "https://keyvault.vault.azure.net",
                  "callCount": 145,
                  "fedrampAuthorized": true
                }
              ]
            }
          }
        },
        "testResults": [
          {
            "test": "Runtime library and dependency discovery",
            "result": "COMPREHENSIVE",
            "details": "234 runtime libraries identified with 12 manifest discrepancies detected"
          },
          {
            "test": "Network connection and DNS resolution monitoring",
            "result": "EXTENSIVE",
            "details": "45 external connections monitored with 7 unauthorized endpoints identified"
          },
          {
            "test": "Cloud service runtime dependency tracking",
            "result": "DETAILED",
            "details": "2690 service calls tracked with FedRAMP authorization validation"
          }
        ],
        "remediation": "Runtime environment dependencies comprehensively monitored and validated"
      },
      {
        "checkId": "TPR-01-004",
        "name": "Incomplete Third-Party Resource Documentation",
        "status": "FAIL",
        "severity": "HIGH",
        "description": "Third-party resources lack comprehensive documentation including risk assessments and approval records",
        "findings": {
          "documentationCompleteness": {
            "inventoriedResources": 1845,
            "documentedResources": 1234,
            "undocumentedResources": 611,
            "riskAssessedResources": 891,
            "approvedResources": 1156,
            "unapprovedResources": 689,
            "documentationGaps": [
              {
                "resourceType": "npm packages",
                "totalResources": 1247,
                "documentedResources": 234,
                "documentationGapPercentage": "81.2%"
              },
              {
                "resourceType": "Container base images",
                "totalResources": 12,
                "documentedResources": 8,
                "documentationGapPercentage": "33.3%"
              },
              {
                "resourceType": "External APIs",
                "totalResources": 15,
                "documentedResources": 9,
                "documentationGapPercentage": "40.0%"
              }
            ]
          },
          "riskAssessmentGaps": {
            "riskAssessmentCoverage": {
              "totalThirdPartyResources": 1845,
              "riskAssessedResources": 891,
              "pendingRiskAssessment": 954,
              "riskAssessmentCompletionRate": "48.3%"
            },
            "riskCategorization": {
              "highRiskResources": 123,
              "mediumRiskResources": 456,
              "lowRiskResources": 312,
              "uncategorizedResources": 954,
              "riskAssessmentCriteria": [
                "Data access capabilities",
                "Network connectivity requirements",
                "Privilege escalation potential",
                "Vulnerability history",
                "Vendor security posture"
              ]
            }
          },
          "approvalProcessGaps": {
            "approvalWorkflowCompliance": {
              "totalResources": 1845,
              "approvedResources": 1156,
              "pendingApproval": 445,
              "rejectedResources": 23,
              "unapprovedUsage": 221,
              "approvalComplianceRate": "62.7%"
            },
            "approvalDocumentation": {
              "approvalRecordsAvailable": 1156,
              "missingApprovalRecords": 689,
              "approvalJustificationDocumented": 892,
              "missingJustification": 264,
              "approvalExpirationTracking": 567,
              "expiredApprovals": 89
            }
          }
        },
        "testResults": [
          {
            "test": "Third-party resource documentation completeness assessment",
            "result": "INADEQUATE",
            "details": "611 of 1845 resources (33.1%) lack proper documentation"
          },
          {
            "test": "Risk assessment coverage evaluation",
            "result": "INSUFFICIENT",
            "details": "48.3% risk assessment completion rate with 954 resources pending assessment"
          },
          {
            "test": "Approval process compliance validation",
            "result": "PARTIAL",
            "details": "62.7% approval compliance with 221 resources in unauthorized usage"
          }
        ],
        "remediation": "HIGH PRIORITY: 1) Document all 611 undocumented third-party resources with comprehensive risk assessments, 2) Complete risk assessments for 954 pending resources using standardized criteria, 3) Implement approval workflow enforcement to prevent unauthorized resource usage, 4) Establish automated documentation requirements in development pipelines, 5) Create centralized third-party resource registry with approval tracking, 6) Implement periodic approval renewal process with expiration monitoring"
      },
      {
        "checkId": "TPR-01-005",
        "name": "Shadow IT and Unauthorized Dependencies",
        "status": "FAIL",
        "severity": "MEDIUM",
        "description": "Unauthorized third-party resources are being used without proper approval or security validation",
        "findings": {
          "unauthorizedSoftwareDependencies": {
            "unauthorizedPackages": {
              "npmUnauthorizedPackages": 45,
              "nugetUnauthorizedPackages": 12,
              "pythonUnauthorizedPackages": 23,
              "totalUnauthorizedPackages": 80,
              "unauthorizedPackageDetails": [
                {
                  "package": "lodash",
                  "version": "4.17.20",
                  "ecosystem": "npm",
                  "riskLevel": "MEDIUM",
                  "vulnerabilities": 2,
                  "reason": "Unapproved direct dependency"
                },
                {
                  "package": "requests",
                  "version": "2.25.1",
                  "ecosystem": "python",
                  "riskLevel": "LOW",
                  "vulnerabilities": 0,
                  "reason": "Missing approval documentation"
                }
              ]
            },
            "unauthorizedContainerImages": {
              "totalUnauthorizedImages": 3,
              "publicRegistryImages": 2,
              "unknownSourceImages": 1,
              "unauthorizedImageDetails": [
                {
                  "image": "redis:alpine",
                  "registry": "docker.io",
                  "riskLevel": "HIGH",
                  "vulnerabilities": 5,
                  "reason": "Unapproved public registry usage"
                }
              ]
            }
          },
          "unauthorizedCloudServices": {
            "shadowCloudServices": {
              "totalShadowServices": 7,
              "unauthorizedSaasServices": 4,
              "unauthorizedApiServices": 3,
              "shadowServiceDetails": [
                {
                  "service": "Slack API",
                  "endpoint": "https://slack.com/api",
                  "riskLevel": "MEDIUM",
                  "dataExposure": "Internal communications",
                  "reason": "Unapproved SaaS integration"
                },
                {
                  "service": "Dropbox API",
                  "endpoint": "https://api.dropboxapi.com",
                  "riskLevel": "HIGH",
                  "dataExposure": "File storage and sharing",
                  "reason": "Unauthorized file sharing service"
                }
              ]
            },
            "unauthorizedNetworkConnections": {
              "suspiciousOutboundConnections": 12,
              "blockedConnections": 8,
              "allowedUnapprovedConnections": 4,
              "connectionDetails": [
                {
                  "destination": "api.telegram.org",
                  "purpose": "Unknown",
                  "riskLevel": "HIGH",
                  "dataTransferred": "Encrypted",
                  "action": "BLOCKED"
                }
              ]
            }
          },
          "riskAssessmentOfUnauthorizedResources": {
            "riskDistribution": {
              "criticalRisk": 3,
              "highRisk": 15,
              "mediumRisk": 34,
              "lowRisk": 28,
              "unknownRisk": 7
            },
            "potentialSecurityImpacts": [
              "Data exfiltration through unauthorized APIs",
              "Vulnerable dependencies introducing security flaws",
              "Compliance violations due to unapproved services",
              "Intellectual property exposure",
              "Privilege escalation through shadow admin tools"
            ]
          }
        },
        "testResults": [
          {
            "test": "Unauthorized software dependency detection",
            "result": "CONCERNING",
            "details": "80 unauthorized packages identified across multiple ecosystems"
          },
          {
            "test": "Shadow cloud service discovery",
            "result": "SIGNIFICANT_RISK",
            "details": "7 shadow services including high-risk file sharing and communication platforms"
          },
          {
            "test": "Risk assessment of unauthorized resources",
            "result": "HIGH_EXPOSURE",
            "details": "18 critical/high-risk unauthorized resources with potential security impacts"
          }
        ],
        "remediation": "MEDIUM PRIORITY: 1) Immediately assess and approve or remove 80 unauthorized software packages, 2) Block access to 7 shadow cloud services pending security review, 3) Implement automated dependency approval workflows in CI/CD pipelines, 4) Deploy network monitoring to detect unauthorized external connections, 5) Establish developer training on approved resource usage policies, 6) Implement automated scanning for unauthorized dependencies in all environments"
      },
      {
        "checkId": "TPR-01-006",
        "name": "Third-Party Resource Change Detection Gaps",
        "status": "FAIL",
        "severity": "LOW",
        "description": "Changes to third-party resources are not consistently monitored and tracked for security implications",
        "findings": {
          "changeMonitoringCoverage": {
            "monitoredResourceTypes": [
              "npm packages",
              "NuGet packages",
              "Container images",
              "Terraform modules"
            ],
            "unmonitoredResourceTypes": [
              "Python packages",
              "External APIs",
              "Helm charts",
              "Browser extensions"
            ],
            "changeDetectionCoverage": "67.3%",
            "changeNotificationSetup": "Basic email alerts"
          },
          "changeTrackingDeficiencies": {
            "dependencyVersionChanges": {
              "totalVersionChanges": 234,
              "trackedChanges": 156,
              "untrackedChanges": 78,
              "securityImplications": [
                {
                  "package": "axios",
                  "oldVersion": "0.21.1",
                  "newVersion": "0.27.2",
                  "securityImpact": "CVE-2022-1214 patched",
                  "trackingStatus": "TRACKED"
                },
                {
                  "package": "urllib3",
                  "oldVersion": "1.26.5",
                  "newVersion": "1.26.12",
                  "securityImpact": "Multiple CVEs patched",
                  "trackingStatus": "UNTRACKED"
                }
              ]
            },
            "configurationChanges": {
              "totalConfigChanges": 89,
              "approvedChanges": 67,
              "unapprovedChanges": 22,
              "changeApprovalWorkflow": "Manual review process",
              "changeRollbackCapability": "Limited"
            }
          },
          "automatedChangeDetection": {
            "automationCapabilities": {
              "dependencyScanningAutomation": "Enabled for 4 ecosystems",
              "vulnerabilityScanningAutomation": "Enabled",
              "licenseComplianceAutomation": "Partially enabled",
              "changeNotificationAutomation": "Basic",
              "changeApprovalAutomation": "Not implemented"
            },
            "detectionGaps": {
              "runtimeChangeDetection": "Limited",
              "configurationDriftDetection": "Basic",
              "newDependencyIntroduction": "Manual process",
              "deprecationTrackingAutomation": "Not implemented",
              "endOfLifeMonitoring": "Manual tracking"
            }
          }
        },
        "testResults": [
          {
            "test": "Change monitoring coverage assessment",
            "result": "PARTIAL",
            "details": "67.3% change detection coverage with 4 unmonitored resource types"
          },
          {
            "test": "Change tracking and approval process evaluation",
            "result": "BASIC",
            "details": "78 untracked version changes with manual approval processes"
          },
          {
            "test": "Automated change detection capability verification",
            "result": "LIMITED",
            "details": "Basic automation with significant gaps in runtime and configuration change detection"
          }
        ],
        "remediation": "LOW PRIORITY: 1) Extend change monitoring to all third-party resource types including Python packages and external APIs, 2) Implement automated change tracking for all dependency version updates, 3) Deploy configuration drift detection for all third-party resource configurations, 4) Establish automated change approval workflows with security impact assessment, 5) Implement comprehensive change notification system with stakeholder alerts, 6) Deploy automated end-of-life and deprecation tracking for all third-party resources"
      }
    ],
    "thirdPartyIdentificationVerificationMethods": {
      "softwareDependencyScanning": [
        "Package manifest analysis: package.json, requirements.txt, *.csproj parsing",
        "Dependency tree analysis: npm audit, pip-audit, NuGet vulnerability scanning",
        "Software composition analysis: WhiteSource, Snyk, FOSSA integration",
        "Container image scanning: Trivy, Twistlock, Azure Container Registry scanning",
        "License compliance checking: FOSSA, WhiteSource license analysis"
      ],
      "infrastructureAsCodeScanning": [
        "Terraform provider analysis: terraform providers command and registry validation",
        "ARM/Bicep template scanning: Azure Resource Manager template analysis",
        "Kubernetes manifest scanning: kubectl and Helm chart dependency analysis",
        "Cloud resource discovery: Azure Resource Graph queries and resource tagging",
        "Configuration drift detection: Terraform plan and Azure Policy compliance"
      ],
      "runtimeEnvironmentMonitoring": [
        "Network traffic analysis: Azure Network Watcher and NSG flow logs",
        "Process monitoring: Azure Security Center and endpoint detection",
        "API call monitoring: Azure API Management and Application Insights",
        "DNS query monitoring: Azure DNS Analytics and threat intelligence",
        "Dynamic library analysis: Runtime dependency injection detection"
      ],
      "documentationAndApprovalTracking": [
        "Asset management systems: ServiceNow, Jira Service Management integration",
        "Risk assessment platforms: GRC tools and security assessment workflows",
        "Approval workflow systems: Azure DevOps, GitHub approval requirements",
        "Compliance tracking: Azure Policy compliance and regulatory mapping",
        "Shadow IT detection: Cloud Access Security Broker (CASB) monitoring"
      ]
    },
    "complianceFrameworks": {
      "fedramp": {
        "SA-4": "Acquisition Process",
        "SA-9": "External Information System Services",
        "SA-12": "Supply Chain Protection",
        "PL-8": "Information Security Architecture",
        "CM-8": "Information System Component Inventory"
      },
      "nist80053": {
        "SA-4": "Acquisition Process",
        "SA-9": "External Information System Services",
        "SA-12": "Supply Chain Protection",
        "PL-8": "Information Security Architecture",
        "CM-8": "Information System Component Inventory",
        "PM-30": "Supply Chain Risk Management Strategy"
      },
      "iso27001": {
        "A.15.1.1": "Information security policy for supplier relationships",
        "A.15.1.2": "Addressing security within supplier agreements",
        "A.15.2.1": "Monitoring and review of supplier services",
        "A.12.6.1": "Management of technical vulnerabilities"
      }
    }
  }
}
