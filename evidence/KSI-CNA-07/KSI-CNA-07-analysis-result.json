{
  "analysis": {
    "id": "KSI-CNA-07",
    "statement": "Ensure cloud-native information resources are implemented based on host provider's best practices and documented guidance",
    "checks": [
      {
        "checkId": "KSI-CNA-07.1",
        "description": "Verify Azure Security Center recommendations compliance",
        "request": "az security assessment list --query '[].{Name:name, Status:status.code, Severity:metadata.severity, ResourceDetails:resourceDetails.id}' --output json",
        "response": [
          {
            "Name": "Secure transfer to storage accounts should be enabled",
            "Status": "Healthy",
            "Severity": "Medium",
            "ResourceDetails": "/subscriptions/12345678-1234-1234-1234-123456789012/resourceGroups/fedramp-prod-rg/providers/Microsoft.Storage/storageAccounts/fedrampstorageacct"
          },
          {
            "Name": "Storage accounts should restrict network access",
            "Status": "Healthy",
            "Severity": "Medium",
            "ResourceDetails": "/subscriptions/12345678-1234-1234-1234-123456789012/resourceGroups/fedramp-prod-rg/providers/Microsoft.Storage/storageAccounts/fedrampstorageacct"
          },
          {
            "Name": "Virtual machines should have endpoint protection solution installed",
            "Status": "Healthy",
            "Severity": "Medium",
            "ResourceDetails": "/subscriptions/12345678-1234-1234-1234-123456789012/resourceGroups/fedramp-prod-rg/providers/Microsoft.Compute/virtualMachines/web-vm-01"
          }
        ],
        "result": "pass"
      },
      {
        "checkId": "KSI-CNA-07.2",
        "description": "Verify Azure Policy compliance for governance standards",
        "request": "az policy state list --filter \"ComplianceState eq 'NonCompliant'\" --query '[].{PolicyDefinitionName:policyDefinitionName, ComplianceState:complianceState, ResourceId:resourceId}' --output json",
        "response": [],
        "result": "pass"
      },
      {
        "checkId": "KSI-CNA-07.3",
        "description": "Verify Azure resources are deployed in supported regions",
        "request": "az resource list --resource-group fedramp-prod-rg --query '[].{Name:name, Type:type, Location:location}' --output json",
        "response": [
          {
            "Name": "fedramp-vnet",
            "Type": "Microsoft.Network/virtualNetworks",
            "Location": "eastus"
          },
          {
            "Name": "fedramp-lb",
            "Type": "Microsoft.Network/loadBalancers",
            "Location": "eastus"
          },
          {
            "Name": "fedrampstorageacct",
            "Type": "Microsoft.Storage/storageAccounts",
            "Location": "eastus"
          },
          {
            "Name": "fedramp-sqlserver",
            "Type": "Microsoft.Sql/servers",
            "Location": "eastus"
          }
        ],
        "result": "pass"
      },
      {
        "checkId": "KSI-CNA-07.4",
        "description": "Verify Azure services use latest API versions and supported SKUs",
        "request": "az resource list --resource-group fedramp-prod-rg --query '[].{Name:name, Type:type, Sku:sku.name, ApiVersion:apiVersion}' --output json",
        "response": [
          {
            "Name": "fedrampstorageacct",
            "Type": "Microsoft.Storage/storageAccounts",
            "Sku": "Standard_GRS",
            "ApiVersion": "2023-01-01"
          },
          {
            "Name": "fedramp-sqlserver",
            "Type": "Microsoft.Sql/servers",
            "Sku": null,
            "ApiVersion": "2023-05-01-preview"
          }
        ],
        "result": "pass"
      }
    ],
    "overall_result": "pass",
    "timestamp": "2025-08-20T11:00:00Z",
    "assessor": "automated-analysis"
  }
}
